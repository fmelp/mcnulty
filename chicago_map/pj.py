import json
import pandas as pd
import re
import numpy as np


with open('subunits.json', 'r') as json_file:
    json_data = json.load(json_file)


# zp_pe = {'60637': 30.8, '60654': 169.8, '60645': -28.1, '60644': -8.3, '60018': -36.2, '60176': -31.0, '60661': 127.1, '60660': 72.9, '60655': -27.9, '60639': -51.9, '60605': 98.0, '60604': 116.6, '60607': 65.3, '60606': 43.8, '60601': 160.3, '60626': 25.5, '60603': 160.8, '60602': 38.6, '60641': -16.1, '60640': 82.2, '60643': -23.3, '60628': -39.2, '60609': -39.8, '60608': -20.7, '60647': 17.4, '60646': 0.0, '60714': -10.5, '60659': -32.3, '60707': -16.5, '60651': -34.4, '60623': -56.7, '60622': 46.0, '60656': 4.9, '60621': -18.3, '60649': 36.0, '60068': -1.1, '60620': -19.5, '60625': -4.5, '60616': 32.5, '60617': -41.5, '60614': 116.1, '60615': 52.9, '60612': 1.8, '60613': 75.3, '60610': 147.4, '60611': 224.2, '60634': -28.0, '60653': 61.7, '60636': -34.6, '60624': -25.9, '60630': -9.0, '60631': -2.4, '60618': 7.9, '60619': 8.1, '60652': -52.5, '60657': 116.2, '60632': -63.4, '60706': -7.0}

#zp_pe = {'60637': -10.1, '60654': 260.7, '60645': -29.0, '60644': -53.4, '60018': -31.9, '60176': -32.0, '60661': 220.1, '60660': 74.4, '60655': -25.9, '60639': -63.5, '60605': 189.6, '60604': 128.7, '60607': 96.1, '60606': 142.9, '60601': 287.6, '60626': 36.4, '60603': 355.1, '60602': 112.3, '60641': -26.1, '60640': 110.0, '60643': -42.4, '60628': -61.3, '60609': -60.6, '60608': -37.2, '60647': 30.4, '60646': 6.0, '60714': -1.2, '60659': -34.0, '60707': -22.6, '60651': -56.9, '60623': -69.0, '60622': 90.7, '60656': 16.4, '60621': -55.6, '60649': 6.3, '60068': 19.3, '60620': -59.5, '60625': 0.0, '60616': 33.3, '60617': -58.0, '60614': 215.4, '60615': 42.5, '60612': -1.8, '60613': 129.4, '60610': 236.8, '60611': 346.8, '60634': -33.9, '60653': 11.0, '60636': -79.1, '60624': -56.9, '60630': -15.8, '60631': 10.0, '60618': 16.6, '60619': -29.7, '60652': -58.1, '60657': 198.7, '60632': -74.7, '60706': -1.4}

zp_pe = {'60637': 67.8, '60654': 454.4, '60645': -38.0, '60644': -15.7, '60018': -43.8, '60176': -34.4, '60661': 373.4, '60660': 159.5, '60655': -28.2, '60639': -69.9, '60605': 259.5, '60604': 225.3, '60607': 180.0, '60606': 143.5, '60601': 410.1, '60626': 63.1, '60603': 433.0, '60602': 106.7, '60641': -25.1, '60640': 189.1, '60643': -28.0, '60628': -49.1, '60609': -50.7, '60608': -26.6, '60647': 36.9, '60646': -0.2, '60714': -21.3, '60659': -47.1, '60707': -19.3, '60651': -48.9, '60623': -71.9, '60622': 96.9, '60656': 18.5, '60621': -22.8, '60649': 75.6, '60068': -3.8, '60620': -26.9, '60625': -1.8, '60616': 68.8, '60617': -50.8, '60614': 286.2, '60615': 125.0, '60612': 14.4, '60613': 202.7, '60610': 366.5, '60611': 471.8, '60634': -38.8, '60653': 102.3, '60636': -49.4, '60624': -38.0, '60630': -11.2, '60631': 0.0, '60618': 18.9, '60619': 20.8, '60652': -64.1, '60657': 292.7, '60632': -78.4, '60706': -12.0}


for i in range(len(json_data['features'])):
    print json_data['features'][i]['properties']
    try:
        json_data['features'][i]['properties']['guests'] = zp_pe[json_data['features'][i]['properties']['ZIP']]
    except:
        json_data['features'][i]['properties']['guests'] = 1
    print json_data['features'][i]['properties']


with open("fixed.json", "w") as f:
    json.dump(json_data, f)


#zp_per = [(60018, -44.7), (60068, 2.7), (60176, -45.8), (60601, 149.7), (60602, 14.8), (60603, 109.6), (60604, 207.6), (60605, 82.4), (60606, 16.2), (60607, 39.7), (60608, -39.1), (60609, -56.4), (60610, 121.9), (60611, 283.0), (60612, -18.1), (60613, 44.7), (60614, 73.7), (60615, 37.7), (60616, 24.8), (60617, -52.5), (60618, -14.8), (60619, 12.4), (60620, -25.5), (60621, -29.3), (60622, 12.9), (60623, -73.5), (60624, -44.9), (60625, -26.5), (60626, 0.0), (60628, -48.2), (60630, -18.0), (60631, -1.8), (60632, -77.6), (60634, -36.4), (60636, -46.4), (60637, 16.9), (60639, -68.1), (60640, 70.1), (60641, -31.4), (60643, -24.6), (60644, -18.4), (60645, -44.0), (60646, 1.8), (60647, -9.7), (60649, 39.0), (60651, -51.8), (60652, -65.3), (60653, 66.2), (60654, 149.7), (60655, -39.7), (60656, 4.3), (60657, 72.6), (60659, -48.7), (60660, 56.5), (60661, 91.0), (60706, 1.5), (60707, -26.1), (60714, 5.7)]
# print zp_per